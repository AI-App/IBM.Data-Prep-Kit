language: python

python:
    - "3.10"

# Enable/install podman
before_install:
    - sudo add-apt-repository -y ppa:projectatomic/ppa
    - sudo apt-get update -qq
    - sudo apt-get install -qq -y software-properties-common podman
    - sudo mkdir -p /etc/containers
    - sudo sh -c 'echo -e "[registries.search]\nregistries = [\"docker.io\"]" > /etc/containers/registries.conf'

script:
    - cd data-processing-lib
    - echo pwd=$(pwd)
    - make venv test
    - echo pwd=$(pwd)
    - cd ../transforms
    - echo pwd=$(pwd)
    - make venv test-lib-src
