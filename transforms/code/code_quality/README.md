# Code Quality 

This module captures code specific metrics of input data.  It includs the metrics discussed or highlighted in CodeParrot and Starcoder data preprocessing pipeline. In the current implementation, the module includes the following metrics & reports each metrics in individual column:

* line specific metrics include mean & max line length
* character and token ratio - uses the input tokenizer to tokenize the input data & measure the ratio between the characters and tokens
* identifies the high occurence of the keywords "test " or "config" and tags them as config or test samples
* tags the samples as autogenerated if the sample contains keywords like `auto-generated`, `autogenerated` or `automatically generated`
* programming language specific identification, where:
    * if the input sample is `python` programming language and sample has no reference to constructs like def, class, it is highlighted as `has_no_keywords` 

This module adds the following fields into the output file:
        "line_mean",
        "line_max",
        "total_num_lines",
        "avg_longest_lines",
        "alphanum_frac",
        "char_token_ratio",
        "autogenerated",
        "config_or_test",
        "has_no_keywords",
        "has_few_assignments",
        "is_xml",
        "is_html"

## Configuration and command line Options

The set of dictionary keys holding [CodeQualityTransform](src/cq_transform.py) configuration for values are as follows:

* "--contents_column_name" - input the name of the column which holds the data to process
* "--language_column_name" - input the name of the column containing the programming language data
* "--tokenizer" - input the tokenizer to use to split data into tokens, by default uses `codeparrot/codeparrot` tokenizer
* "--hf_token" - input the Hugging Face auth token to use to access the tokenizer

## Running

We provide a demo of the transform usage for [local file system](src/cq_local.py)

